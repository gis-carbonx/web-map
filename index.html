<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Interactive Web Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-filelayer"></script>
  <script src="https://unpkg.com/togeojson@0.16.0"></script>
  <script src="https://unpkg.com/jszip@3.10.1/dist/jszip.min.js"></script>
  <script src="https://unpkg.com/shpjs@latest/dist/shp.min.js"></script>
</head>
<body>
  <h3 style="text-align:center">Interactive Web Map with Upload</h3>
  <div id="map" style="width: 100%; height: 90vh;"></div>

  <script>
    var map = L.map('map').setView([-2, 117], 5);

    var baseMaps = {
      "OpenStreetMap": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Â© OpenStreetMap'
      }).addTo(map)
    };

    var overlays = {};

    function loadGeoJSON(url, name, color) {
      fetch(url)
        .then(res => res.json())
        .then(data => {
          var layer = L.geoJSON(data, {
            style: { color: color, weight: 2, fillOpacity: 0.3 }
          }).bindPopup(name);

          overlays[name] = layer;
          layer.addTo(map);
          layerControl.addOverlay(layer, name);
        })
        .catch(err => console.error("Error loading " + name, err));
    }

    var layerControl = L.control.layers(baseMaps, overlays).addTo(map);

    loadGeoJSON("https://drive.google.com/uc?id=1k-lkxY1hUZ_i807a-fTrs3tB7Vy-yW8H", "LULC2023", "green");
    loadGeoJSON("https://drive.google.com/uc?id=1DIKQ48RuYtbpM2bdJ4-8a925eN6jKtfx", "LULC2013", "orange");
    loadGeoJSON("https://drive.google.com/uc?id=1Lx1KSSsZazu6fM6_t3VbkjQEjGH52T2C", "Eligible Area", "blue");

    loadGeoJSON("data/Blok.json", "Blok", "red");
    loadGeoJSON("data/VillageBoundaries.json", "Village Boundaries", "purple");

    L.Control.FileLayerLoad.LABEL = '<i class="fa fa-folder-open"></i>';
    L.Control.fileLayerLoad({
      fitBounds: true,
      layerOptions: { style: { color: 'black', weight: 2, fillOpacity: 0.5 } },
      addToMap: true
    }).addTo(map);

  </script>
</body>
</html>
